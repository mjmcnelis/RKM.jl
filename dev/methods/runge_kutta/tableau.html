<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Method construction · RKM.jl</title><meta name="title" content="Method construction · RKM.jl"/><meta property="og:title" content="Method construction · RKM.jl"/><meta property="twitter:title" content="Method construction · RKM.jl"/><meta name="description" content="Documentation for RKM.jl."/><meta property="og:description" content="Documentation for RKM.jl."/><meta property="twitter:description" content="Documentation for RKM.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../index.html">RKM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../index.html">Home</a></li><li><a class="tocitem" href="../../overview.html">Overview</a></li><li><a class="tocitem" href="../../module.html">Module</a></li><li><span class="tocitem">Methods</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox" checked/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Runge-Kutta</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="runge_kutta.html">Runge-Kutta update</a></li><li class="is-active"><a class="tocitem" href="tableau.html">Method construction</a><ul class="internal"><li><a class="tocitem" href="#Example"><span>Example</span></a></li><li><a class="tocitem" href="#API-Reference"><span>API Reference</span></a></li></ul></li><li><a class="tocitem" href="debug_table.html">Debugging the Butcher tableau</a></li><li><input class="collapse-toggle" id="menuitem-4-1-4" type="checkbox"/><label class="tocitem" for="menuitem-4-1-4"><span class="docs-label">Explicit methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="explicit/low_order.html">Low-order</a></li><li><a class="tocitem" href="explicit/medium_order.html">Medium-order</a></li><li><a class="tocitem" href="explicit/high_order.html">High-order</a></li><li><a class="tocitem" href="explicit/very_high_order.html">Very high-order</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-1-5" type="checkbox"/><label class="tocitem" for="menuitem-4-1-5"><span class="docs-label">Implicit methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="implicit/low_order.html">Low-order</a></li></ul></li></ul></li></ul></li><li><span class="tocitem">Adaptive Time Step</span><ul><li><a class="tocitem" href="../../adaptive/constructor.html">Options and parameters</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Algorithms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../adaptive/algorithms/doubling.html">Step doubling</a></li><li><a class="tocitem" href="../../adaptive/algorithms/embedded.html">Embedded</a></li><li><a class="tocitem" href="../../adaptive/algorithms/finite_diff.html">Finite difference</a></li></ul></li></ul></li><li><a class="tocitem" href="../../monitor/monitor.html">Monitoring</a></li><li><span class="tocitem">Post-process solution</span><ul><li><a class="tocitem" href="../../solution/solution_data.html">Solution data</a></li><li><a class="tocitem" href="../../solution/dense_output.html">Dense output</a></li></ul></li><li><a class="tocitem" href="../../statistics.html">Solver statistics</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Methods</a></li><li><a class="is-disabled">Runge-Kutta</a></li><li class="is-active"><a href="tableau.html">Method construction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="tableau.html">Method construction</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mjmcnelis/RKM.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Method-construction"><a class="docs-heading-anchor" href="#Method-construction">Method construction</a><a id="Method-construction-1"></a><a class="docs-heading-anchor-permalink" href="#Method-construction" title="Permalink"></a></h1><p>In this section, we discuss how a Runge-Kutta method&#39;s Butcher tableau and properties are constructed and stored in the <code>RungeKutta</code> struct.</p><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>Here we set the ODE solver method to the classic fourth-order Runge-Kutta method:</p><pre><code class="language-julia hljs">method = RungeKutta4()</code></pre><p>The code for this method&#39;s constructor is</p><pre><code class="language-julia hljs">function RungeKutta4(precision::Type{T} = Float64) where T &lt;: AbstractFloat
    butcher = [0 0 0 0 0
               1//2 1//2 0 0 0
               1//2 0 1//2 0 0
               1 0 0 1 0
               1 1//6 1//3 1//3 1//6]
    butcher = butcher .|&gt; precision

    return RungeKutta(; name = :Runge_Kutta_4, butcher)
end</code></pre><p>First we write out the Butcher tableau in <code>Matrix</code> form. If the coefficients are simple, we express them as integers and fractions (otherwise we use <code>big</code> strings). The matrix <code>butcher</code> is converted to the float type <code>precision</code>, which is set by the user.</p><p>Next, we pass <code>butcher</code> and a symbolic label <code>name</code> to <code>RungeKutta</code>&#39;s outer constructor. The outer constructor partitions <code>butcher</code> into the arrays <code>c</code>, <code>A_T</code> and <code>b</code> (<code>b_hat</code>) and stores them as static types. It also infers several properties, such as the number of stages and whether the method is explicit or implicit. The order of the primary (embedded) update is extracted by parsing <code>name</code>. The code below shows the fields of the <code>RungeKutta</code> struct <code>method</code> after it is set to <code>RungeKutta4()</code>:</p><pre><code class="language-julia hljs">julia&gt; for field in method |&gt; typeof |&gt; fieldnames
           println(&quot;$field = $(getproperty(method, field))&quot;)
       end
name = Runge_Kutta_4
c = [0.0, 0.5, 0.5, 1.0]
A_T = [0.0 0.5 0.0 0.0; 0.0 0.0 0.5 0.0; 0.0 0.0 0.0 1.0; 0.0 0.0 0.0 0.0]
b = [0.16666666666666666, 0.3333333333333333, 0.3333333333333333, 0.16666666666666666]
b_hat = [0.16666666666666666, 0.3333333333333333, 0.3333333333333333, 0.16666666666666666]
stages = 4
order = [4.0]
iteration = Explicit()
fesal = false
code_name = RK4</code></pre><p><em>Note: the <code>1</code> entry in the lower-left corner of <code>butcher</code> is only used as a placeholder to verify that the coefficients in <code>b</code> (<code>b_hat</code>) sum up to unity within floating precision.</em></p><h2 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RKM.RungeKutta" href="#RKM.RungeKutta"><code>RKM.RungeKutta</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct RungeKutta{T, S, S2, E, SE, R, Q, RQ, P, I, F} &lt;: RKM.ODEMethod</code></pre><p>Stores the Butcher tableau and properties of a given Runge-Kutta method.</p><p><strong>Fields</strong></p><ul><li><p><code>name::Symbol</code>: Name of the Runge-Kutta method</p></li><li><p><code>c::StaticArraysCore.SVector{S, T} where {T, S}</code>: Intermediate time update coefficient of each stage in the Butcher tableau</p></li><li><p><code>A_T::StaticArraysCore.SMatrix{S, S, T} where {T, S}</code>: Transposed intermediate state update coefficients of each stage in the Butcher tableau</p></li><li><p><code>b::StaticArraysCore.SVector{S, T} where {T, S}</code>: Primary state update coefficients of the Butcher tableau</p></li><li><p><code>b_hat::StaticArraysCore.SMatrix{E, S, T} where {T, S, E}</code>: Embedded state update coefficients (if any) of the Butcher tableau</p></li><li><p><code>ω::StaticArraysCore.SMatrix{R, Q, T} where {T, R, Q}</code>: Polynomial coefficients used for continuous output</p></li><li><p><code>stages::Int64</code>: Number of stages in the Runge-Kutta method</p></li><li><p><code>order::StaticArraysCore.SVector{P, T} where {T, P}</code>: Order of the primary (and embedded) update(s) of the Runge-Kutta method</p></li><li><p><code>iteration::Any</code>: Determines whether the method is explicit or full/diagonal implicit</p></li><li><p><code>fesal::Bool</code>: Determines whether the method has the FESAL property (see ../properties/fesal.jl)</p></li><li><p><code>explicit_stage::StaticArraysCore.SVector{S, Bool} where S</code>: Determines which stages are explicit</p></li><li><p><code>code_name::String</code>: Abbreviated name for the Runge-Kutta method</p></li><li><p><code>reconstructor::Any</code>: Function used to reconstruct Runge-Kutta method</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mjmcnelis/RKM.jl">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="RKM.RungeKutta-Union{Tuple{RQ}, Tuple{Q}, Tuple{R}, Tuple{NM}, Tuple{M}, Tuple{N}, Tuple{T}, Tuple{Symbol, StaticArraysCore.SMatrix{N, M, T, NM}, Iteration, Function}} where {T&lt;:AbstractFloat, N, M, NM, R, Q, RQ}" href="#RKM.RungeKutta-Union{Tuple{RQ}, Tuple{Q}, Tuple{R}, Tuple{NM}, Tuple{M}, Tuple{N}, Tuple{T}, Tuple{Symbol, StaticArraysCore.SMatrix{N, M, T, NM}, Iteration, Function}} where {T&lt;:AbstractFloat, N, M, NM, R, Q, RQ}"><code>RKM.RungeKutta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RungeKutta(name::Symbol, butcher::SMatrix{N, M, T, NM},
           iteration::Iteration, reconstructor::Function;
           ω::SMatrix{R, Q, T, RQ} = SMatrix{0,0,T,0}()
          ) where {T &lt;: AbstractFloat, N, M, NM, R, Q, RQ}</code></pre><p>Outer constructor for <code>RungeKutta</code>.</p><p>Required parameters: <code>name</code>, <code>butcher</code>, <code>iteration</code>, <code>reconstructor</code></p><p>Note: <code>ω</code> are interpolation coefficients used for continuous output,       but some methods may not have them.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mjmcnelis/RKM.jl">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="runge_kutta.html">« Runge-Kutta update</a><a class="docs-footer-nextpage" href="debug_table.html">Debugging the Butcher tableau »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 12 September 2025 23:19">Friday 12 September 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
