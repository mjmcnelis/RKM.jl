<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Dense output · RKM.jl</title><meta name="title" content="Dense output · RKM.jl"/><meta property="og:title" content="Dense output · RKM.jl"/><meta property="twitter:title" content="Dense output · RKM.jl"/><meta name="description" content="Documentation for RKM.jl."/><meta property="og:description" content="Documentation for RKM.jl."/><meta property="twitter:description" content="Documentation for RKM.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">RKM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><a class="tocitem" href="../overview.html">Overview</a></li><li><a class="tocitem" href="../module.html">Module</a></li><li><span class="tocitem">Methods</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Runge-Kutta</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../methods/runge_kutta/runge_kutta.html">Runge-Kutta update</a></li><li><a class="tocitem" href="../methods/runge_kutta/tableau.html">Method construction</a></li><li><a class="tocitem" href="../methods/runge_kutta/debug_table.html">Debugging the Butcher tableau</a></li><li><a class="tocitem" href="../methods/runge_kutta/explicit_runge_kutta.html">Explicit Runge-Kutta methods</a></li><li><a class="tocitem" href="../methods/runge_kutta/implicit_runge_kutta.html">Implicit Runge-Kutta methods</a></li></ul></li></ul></li><li><span class="tocitem">Adaptive Time Step</span><ul><li><a class="tocitem" href="../adaptive/constructor.html">Options and parameters</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Algorithms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../adaptive/algorithms/doubling.html">Step doubling</a></li><li><a class="tocitem" href="../adaptive/algorithms/embedded.html">Embedded</a></li><li><a class="tocitem" href="../adaptive/algorithms/finite_diff.html">Finite difference</a></li></ul></li></ul></li><li><a class="tocitem" href="../solver_options.html">Solver options</a></li><li><a class="tocitem" href="../monitor/monitor.html">Monitoring</a></li><li><span class="tocitem">Post-process solution</span><ul><li><a class="tocitem" href="solution_data.html">Solution data</a></li><li class="is-active"><a class="tocitem" href="dense_output.html">Dense output</a><ul class="internal"><li><a class="tocitem" href="#No-interpolation"><span>No interpolation</span></a></li><li><a class="tocitem" href="#Cubic-Hermite"><span>Cubic Hermite</span></a></li><li><a class="tocitem" href="#Continuous-formula"><span>Continuous formula</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../statistics.html">Solver statistics</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Post-process solution</a></li><li class="is-active"><a href="dense_output.html">Dense output</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="dense_output.html">Dense output</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mjmcnelis/RKM.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Dense-output"><a class="docs-heading-anchor" href="#Dense-output">Dense output</a><a id="Dense-output-1"></a><a class="docs-heading-anchor-permalink" href="#Dense-output" title="Permalink"></a></h1><p>Interpolation can only be performed after solving the ODE, since it uses raw solution data as input. In addition to the state variables, the cubic Hermite and continuous formula routines use time derivative and intermediate stage data, respectively. You will need to change the solver option <code>interpolator</code> to solve and store the solution variables required by each routine.</p><h2 id="No-interpolation"><a class="docs-heading-anchor" href="#No-interpolation">No interpolation</a><a id="No-interpolation-1"></a><a class="docs-heading-anchor-permalink" href="#No-interpolation" title="Permalink"></a></h2><p>If you do not plan to interpolate the solution, use the default value <code>interpolator = NoInterpolator()</code>. The solver will only output the time series and state variables of the raw solution.</p><h2 id="Cubic-Hermite"><a class="docs-heading-anchor" href="#Cubic-Hermite">Cubic Hermite</a><a id="Cubic-Hermite-1"></a><a class="docs-heading-anchor-permalink" href="#Cubic-Hermite" title="Permalink"></a></h2><p>All ODE methods can use cubic Hermite interpolation to generate dense output. Here, we continue with the overdamped oscillator example and set the solver option <code>interpolator = CubicHermite()</code>. The solver will output the time derivatives, which is stored in <code>sol.f</code>.</p><pre><code class="language-julia hljs">using RKM
using Plots; plotly()

function dy_dt!(f, y, t; p, kwargs...)
    γ = p[1]
    ω = p[2]
    f[1] = y[2]
    f[2] = -γ*y[2] - ω^2*y[1]
    return nothing
end

y0 = [1.0, -1.0]  # [position, velocity]
t0 = 0.0
tf = 10.0
dt0 = 1e-2

γ = 101.0         # damping coefficient
ω = 10.0          # frequency
p = [γ, ω]

options = SolverOptions(; method = TrapezoidRuleBDF2(),
                          adaptive = Embedded(; alpha = 1e-3),
                          interpolator = CubicHermite(),);

sol = evolve_ode(y0, t0, tf, dt0, dy_dt!, options, p);</code></pre><p>First, we plot the non-uniform solution data from the adaptive TRBDF2 method:</p><pre><code class="language-julia hljs">t, y = get_solution(sol);
scatter(t, y; xlabel = &quot;t&quot;, ylabel = &quot;y&quot;, label = [&quot;x&quot; &quot;v&quot;], color = [:red :blue], ms = 3)</code></pre><img src="images/scatter_plot.png" width="600"><p>Next, we call <code>interpolate_solution</code> to interpolate the data uniformly (the keyword argument <code>dt_dense</code> controls the temporal spacing).</p><pre><code class="language-julia hljs">t_dense, y_dense = interpolate_solution(options, sol; dt_dense = 1e-4);
plot!(t_dense, y_dense; label = [&quot;x (dense)&quot; &quot;v (dense)&quot;], color = [:red :blue])</code></pre><p>The interpolated solution is <span>$C^1$</span> continuous and third-order accurate (i.e. it has a local error of <span>$\mathcal{O}(\Delta t_n^4)$</span> between the raw time intervals <span>$[t_n, t_{n+1}]$</span>).</p><img src="images/hermite_plot.png" width="600"><h2 id="Continuous-formula"><a class="docs-heading-anchor" href="#Continuous-formula">Continuous formula</a><a id="Continuous-formula-1"></a><a class="docs-heading-anchor-permalink" href="#Continuous-formula" title="Permalink"></a></h2><p>If the ODE method has a continuous formula that uses intermediate stages, you can set <code>interpolator = ContinuousFormula()</code>. After solving the ODE, the intermediate stage data will be stored in <code>sol.dy</code>.</p><pre><code class="language-julia hljs">options = SolverOptions(; method = TrapezoidRuleBDF2(),
                          adaptive = Embedded(; alpha = 1e-3),
                          interpolator = ContinuousFormula(),);

sol = evolve_ode(y0, t0, tf, dt0, dy_dt!, options, p);</code></pre><p>Then call <code>interpolate_solution</code> to use the continuous formula. The function also displays the formula&#39;s order and degree of continuity (either <span>$C^0$</span> or <span>$C^1$</span>).</p><pre><code class="language-julia hljs">julia&gt; t_dense, y_dense = interpolate_solution(options, sol; dt_dense = 1e-4);
[ Info: Generating order-2 C0 continuous output for TrapezoidRuleBDF2</code></pre><p>The TRBDF2 continuous formula is less accurate and smooth than cubic Hermite interpolation, but it qualitatively produces the same curves:</p><pre><code class="language-julia hljs">t, y = get_solution(sol);
scatter(t, y; xlabel = &quot;t&quot;, ylabel = &quot;y&quot;, label = [&quot;x&quot; &quot;v&quot;], color = [:red :blue], ms = 3);
plot!(t_dense, y_dense; label = [&quot;x (dense)&quot; &quot;v (dense)&quot;], color = [:red :blue])</code></pre><img src="images/continuous_plot.png" width="600"><h3 id="Compatibility-with-step-doubling"><a class="docs-heading-anchor" href="#Compatibility-with-step-doubling">Compatibility with step-doubling</a><a id="Compatibility-with-step-doubling-1"></a><a class="docs-heading-anchor-permalink" href="#Compatibility-with-step-doubling" title="Permalink"></a></h3><p>You can still use the continuous formula if you used step-doubling for the adaptive time step. However, the raw solution&#39;s global accuracy is reduced by one order (the solver updates the state with a regular time step instead of an extrapolated step).</p><pre><code class="language-julia hljs">options = SolverOptions(; method = TrapezoidRuleBDF2(),
                          adaptive = Doubling(),
                          interpolator = ContinuousFormula(),);

sol = evolve_ode(y0, t0, tf, dt0, dy_dt!, options, p);

t, y = get_solution(sol);
t_dense, y_dense = interpolate_solution(options, sol; dt_dense = 1e-4);

scatter(t, y; xlabel = &quot;t&quot;, ylabel = &quot;y&quot;, label = [&quot;x&quot; &quot;v&quot;], color = [:red :blue], ms = 3);
plot!(t_dense, y_dense; label = [&quot;x (dense)&quot; &quot;v (dense)&quot;], color = [:red :blue])</code></pre><img src="images/continuous_plot_2.png" width="600"><p>We recommend using the continuous formula with an embedded Runge-Kutta method instead.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="solution_data.html">« Solution data</a><a class="docs-footer-nextpage" href="../statistics.html">Solver statistics »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 3 December 2025 07:59">Wednesday 3 December 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
